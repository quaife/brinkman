\documentclass[aps,prl,showpacs]{revtex4}
\usepackage{amsmath,amsfonts,bm, color}
\usepackage{graphicx,epsfig}
\usepackage{todonotes}
%Dfig puts a figure of specified size at the place indicated.
\newcommand{\Dfig}[2]{\epsfig{figure=#1,width=#2cm}}

 
%\Eonefigs puts one figure at the top of a page. 3 arguments.
%Usage:
%\Eonefigs{file fig}{caption}{size in inches}
%the file must be eps, but names must be given 
%WITHOUT .eps extension

\newenvironment{Eonefigs}[3]
{        \begin{figure} [t]
          \begin{center}
              \includegraphics[width=0.5\textwidth]{#3} \\
          \vspace{-0.21in}
          \caption{{\footnotesize #2}}
          \label{#1}
          \end{center}
        \vspace{-.3in}
        \end{figure}
}{}


\newcommand{\co}[1]{\marginpar{\scriptsize \textcolor{red}{#1}}} % red comment

\input my_macros2.tex	

\begin{document}

\title{Semi-permeable vesicles: mathematical formulation, numerics and physics}
\author{Ashley Gannon, Bryan Quaife, Shravan Veerapaneni, and Yuan-Nan Young}

\date{\today}

\begin{abstract}
We describe a mathematical model for a semi-permeable vesicle and derive
  a boundary integral equation formulation for simulating its
  hydrodynamics.  
\end{abstract}
\maketitle


\section{Problem formulation} \label{sc:formulate}
Consider a two-dimensional semi-permeable vesicle suspended in an
unbounded viscous fluid domain, subjected to an imposed flow
$\mbu_\infty(\mbx)$, for any $\mbx \in \RR^2$.  Assume that the interior
and exterior fluids have the same viscosity $\mu$. Let $\mbx$ be the
position of the interface $\gamma$, $\mbu$ be the fluid velocity, and
$p$ be the pressure. In the vanishing Reynolds number limit, the
governing equations for the ambient fluid are
%
\begin{subequations}
\begin{alignat}{3}
  \label{eqn:governing}
  -\nabla p + \mu \triangle \mbu &= 0, 
  &&\mbx \in \RR^2 \setminus \gamma, \\
% 
  \nabla \cdot \mbu &= 0,  &&\mbx \in \RR^2 \setminus \gamma, \\
%
  \mbu(\mbx) &\rightarrow \mbu_\infty(\mbx),
    \qquad &&\norm{\mbx} \rightarrow \infty.
\end{alignat}
\end{subequations}%
%
Letting $\mbn$ be the outward normal to $\gamma$, $\jump{\cdot}$ denote
the jump across the interface, and $T$ denote the hydrodynamic stress
tensor, the boundary conditions along the vesicle are
\begin{align}
  \label{eqn:jump1}
  \jump{T\cdot\mbn} &= \mbf_\text{mem}, \\
  \label{eqn:jump2}
  \jump{\mbu} &= 0,
\end{align}
where $\mbf_\text{mem}$ is the standard membrane force that includes a
bending and a tension term. In particular, $\mbf_\text{mem} =
\mbf_\text{ben} + \mbf_\text{ten}$, where
\begin{align}
  \label{eqn:membraneForces}
  \mbf_\text{ben} = -\kappa_b \mbx_{ssss}, \qquad
  \mbf_\text{ten} = (\sigma \mbx_s)_s,
\end{align}
where $\kappa_b$ is the bending stiffness and $\sigma$ is a Lagrange
multiplier, which acts like the tension, which is used to satisfy the
inextensibility condition.

The kinematic condition is modified to account for the fact that the
fluid can move through the membrane. A standard choice appears
is~\cite{}
\begin{align}
  \mbu - \dot{\mbx} = - \beta (\mbf_\text{mem} \cdot \mbn) \mbn, \qquad
  \mbx \in \gamma,
\end{align}
where $\beta$ is a semi-permeability rate.  

\subsection{Integral equation formulation}
Since the flow is governed by the linear Stokes equations, it can be
represented in terms of layer potentials. Given the boundary
conditions~\eqref{eqn:jump1} and~\eqref{eqn:jump2} required on the
interface, the fluid velocity can be represented as the single-layer
potential
\begin{align}
  \mbu(\mbx) = \mbu_\infty(\mbx) + \sgl[\mbf_\text{mem}](\mbx), \quad
    \mbx \in \Omega,
\end{align}
where
\begin{align}
  \sgl[\mbf](\mbx) = \frac{1}{4\pi\mu} \int_{\gamma} \left(
    -\mathbf{I} \log\rho + \frac{\mbr \otimes \mbr}{\rho^2} \right)
    \mbf(\mby) ds_{\mby},
\end{align}
where $\mbr = \mbx - \mby$ and $\rho = \norm{\mbr}$. Then, by the
kinematic equation, the dynamics of the vesicle 
\begin{align}
  \label{eqn:vesVelocity}
  \frac{d\mbx}{dt} = \mbu_\infty(\mbx) + \beta (\mbf_\text{mem}\cdot\mbn)\mbn
  + \sgl [\mbf_\text{mem}](\mbx).
\end{align}
Finally, the inextensibility condition is given by
\begin{align}
  \mbx_s\cdot\dot{\mbx}_s = 0.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Vesicle Area}
Since the vesicle membrane is semi-permeable, the vesicle's area
fluctuates.  Parameterizing the vesicle with $\mbx$, its area is
\begin{align}
  A(t) = \frac{1}{2}\int_{\gamma} (\mbx \cdot \mbn)\, ds = 
    \frac{1}{2}\int_{0}^{2\pi} \left(\mbx \cdot \pderiv{\mbx}{\theta}^\perp\right)
    \, d\theta.
\end{align}

\todo[inline]{Can do this part of the calculation using FTC}
Taking the time derivative of $A(t)$,
\begin{align}
  \dot{A}(t) &= \frac{1}{2}\int_{0}^{2\pi} \left(\dot{\mbx} \cdot
  \pderiv{\mbx}{\theta}^{\perp} + 
    \mbx \cdot \pderiv{\dot{\mbx}}{\theta}^{\perp}\right) d\theta, \\
  &= \frac{1}{2}
  \int_{0}^{2\pi}(\dot{\mbx}\cdot\mbn)\left\|\pderiv{\mbx}{\theta}\right\|d\theta +
     \frac{1}{2}\int_{0}^{2\pi}
    \left(\mbx \cdot \pderiv{\dot{\mbx}}{\theta}^{\perp}\right)d\theta, \\
  &= \frac{\beta}{2} \int_{\gamma}\left(\mbf\cdot\mbn\right)ds +
  \frac{1}{2}\int_{0}^{2\pi}\left(\mbx \cdot \pderiv{}{t}\left(\mbn
  \left\|\pderiv{\mbx}{\theta}\right\|\right)\right)d\theta, \\
  &= \frac{\beta}{2} \int_{\gamma}\left(\mbf\cdot\mbn\right)ds + \frac{1}{2}
  \int_{\gamma}\left(\mbx\cdot\dot{\mbn}\right)ds + \frac{1}{2}\int_{0}^{2\pi}
  \frac{\mbx\cdot\mbn}{\left\|\pderiv{\mbx}{\theta}\right\|}
  \left(\pderiv{\mbx}{\theta}\cdot
  \pderiv{\dot{\mbx}}{\theta}\right)d\theta \\
  &= \frac{\beta}{2} \int_{\gamma}\left(\mbf\cdot\mbn\right)ds + \frac{1}{2}
  \int_{\gamma}\left(\mbx\cdot\dot{\mbn}\right)ds + \frac{1}{2}\int_{\gamma}
  (\mbx\cdot\mbn) (\mbx_s \cdot \dot{\mbx}_s)\, ds.
\end{align}
To satisfy the inextensibilty condition, $\mbx_s \cdot \dot{\mbx}_s = 0$.
Therefore the time derivative of $A(t)$ is
\begin{align}
     \dot{A}(t) &= \frac{\beta}{2} \int_{\gamma}\left(\mbf\cdot\mbn\right)ds
     + \frac{1}{2} \int_{\gamma}\left(\mbx\cdot\dot{\mbn}\right)ds.
\end{align}
which we re-write as
\begin{align}
    \dot{A}(t) &= \frac{\beta}{2}
    \int_{\gamma}\left(\mbf\cdot\mbn\right)ds-\frac{1}{2}\int_{\gamma}\left(\mbx^{\perp}\cdot\dot{\mbx}_s\right) ds.
\end{align}
Applying integration by parts,
\begin{align}
    \dot{A}(t) &= \frac{\beta}{2}
    \int_{\gamma}\left(\mbf\cdot\mbn\right)ds+\frac{1}{2}\int_{\gamma}\left(\mbx^{\perp}_s\cdot\dot{\mbx}\right) ds,
\end{align}
which we re-write as
\begin{align}
    \dot{A}(t) &= \frac{\beta}{2}
    \int_{\gamma}\left(\mbf\cdot\mbn\right)ds+\frac{1}{2}\int_{\gamma}\left(\dot{\mbx}\cdot\mbn\right),\\
    \dot{A}(t) &= \beta \int_{\gamma}\left(\mbf\cdot\mbn\right)ds.
\end{align}
At steady state,
\begin{align}
    \dot{A}(t) &= \beta \int_{\gamma}\left(\mbf\cdot\mbn\right)ds =0.
\end{align}
We now replace $\mbf$ with its definition and apply integration by parts
\begin{align}
   0=\beta\int_{\gamma} 
    (-\kappa_b\mbx_{ssss}+(\sigma\mbx_s)_s)\cdot\mbn\, ds =
   \beta\int_{\gamma}\left(\kappa_b\mbx_{sss}-\sigma\mbx_s\right)\cdot
     \mbn_s\, ds
\end{align}
From the Frenet-Serret formulas, we have 
\begin{align}
     -\beta\int_{\gamma}
     \left(\kappa_b\mbx_{sss}-\sigma\mbx_s\right)\cdot\kappa\mbx_s ds &=0.
\end{align}

Applying integration by parts and Frenet-Serret again
\begin{align}
     \beta\int_{\gamma}
     \kappa_b\kappa\left(\mbx_{ss}\cdot\mbx_{ss}\right)ds + \beta
     \int_{\gamma} \kappa_b \kappa_s(\mbx_{ss} \cdot \mbx_s)ds +\beta\int_{\gamma}\kappa\sigma ds  &= 0,\\
    \beta\int_{\gamma} \kappa_b\kappa(\kappa\mbn \cdot
     \kappa\mbn)+ \beta \int_{\gamma} \kappa_b \kappa_s(\mbx_{ss} \cdot
     \mbx_s)ds +\beta\int_{\gamma}\kappa\sigma ds &= 0,
\end{align}
which we re-write as
\begin{align}
   \beta\int_{\gamma}\kappa_b\kappa^3 ds + \beta \int_{\gamma} \kappa_b
   \kappa_s(\mbx_{ss} \cdot \mbx_s)ds +\beta\int_{\gamma} \kappa\sigma ds = 0.
\end{align}
Applying Frenet-serret again,
\begin{align}
    \beta\int_{\gamma}\kappa_b\kappa^3 ds + \beta \int_{\gamma} \kappa_b
    \kappa_s(\kappa\mbn \cdot \TT)ds +\beta\int_{\gamma} \kappa\sigma ds = 0, \\
    \beta\int_{\gamma}\kappa_b\kappa^3 ds +\beta\int_{\gamma} \kappa\sigma ds  = 0.
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Methods}
\subsection{Discretization in Space}

\subsection{Discretization in Time}
By using an integral equation formulation, the only unknowns are the
vesicle position and tension, and the flow in the bulk does not have to
be computed. However, the high-order derivatives in the bending and
tension forces~\eqref{eqn:membraneForces} result in stiffness if an
explicit time stepping method is applied to
equation~\eqref{eqn:vesVelocity}. We apply a similar semi-implicit time
stepping method to our previous works~\cite{vee-gue-zor-bir2009,
qua-bir2014}. First, given a vesicle $\gamma$, with a boundary
parameterized as $\mbx(s)$, we introduce notation for all the required
differential and projection operators
\begin{align}
  B[\mbx]\mbf &= -\frac{d^4}{ds^4} \mbf, \\
  T[\mbx]\sigma &= (\sigma \mbx_s)_s, \\
  D[\mbx]\mbf &= \mbx_s \cdot \mbf_s, \\
  P[\mbx]\mbf &= (\mbf \cdot \mbn) \mbn. 
\end{align}
Here, the normal vector $\mbn$ is the outward unit normal of the
$\gamma$, and $d/ds$ is its arclength derivative. To simplify notation,
we write $B\mbf$ to mean $B[\mbx]\mbf$, and use similar notation for the
other operators. Then, the dynamics of the vesicle are governed by
\begin{align}
  \frac{d\mbx}{dt} &= \mbu_{\infty}(\mbx) + 
  \beta P(B\mbx + T\sigma) + \sgl(B\mbx + T\sigma), \\
  D \frac{d\mbx}{dt} &= 0.
\end{align}
By writing $B^N$ to mean the bending operator due to the vesicle
configuration at time $t_N$, and similar notation for the other
operators, we address the stiffness by introducing the semi-implicit
time stepping method
\begin{align}  
  \frac{\mbx^{N+1} - \mbx^N}{\Delta t} = \mbu_\infty(\mbx^N) 
  + \beta P^N\left(B^N\mbx^{N+1} + T^N\sigma^{N+1}\right) 
  + \sgl^N\left(B^N\mbx^{N+1} + T^N\sigma^{N+1}\right).
\end{align}
Finally, the inextensibility condition is applied by requiring that 
\begin{align}
  D^N\mbx^{N+1} = 1.
\end{align}

\todo[inline]{A few lines about SDC}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Examples}
We consider a single semi-permeable vesicle in four different flow
regimes.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quiescent Flow}
\begin{itemize}
  \item Always goes to a circle
  \item Area formula works
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Shear Flow}
\begin{itemize}
  \item Never goes to a circle
  \item Area formula works
  \item Mild dependence on initial shape
  \item Most slender tank treading shapes seen for small $\beta$ and
    large $\chi$
\end{itemize}

%\input{figures/shearPhaseDiagram.tikz}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Extensional Flow}
\begin{itemize}
  \item ???
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Poiseuille Flow}
\begin{itemize}
  \item ???
\end{itemize}





 \bibliographystyle{plain}
 \bibliography{refs}




 \newpage
 \paragraph{\bf \Huge OLD STUFF}

%%%%%%%%%%%%%%
\section{{$\Theta-L$} formulation}
Here, we attempt to apply the formulation described by Sohn et
al.~\cite{soh-tse-li-voi-low2010} to a semi-permeable vesicle.  In the
semi-permeable formulation, the vesicle velocity is
\begin{align}
  \pderiv{\XX}{t} = \mbu(\XX(t)) + \beta (\mbf \cdot \mbn) \mbn.
\end{align}
In the {$\Theta-L$} variables, we require a normal velocity $V$, and a
tangential velocity $T$. Since the inextensibility condition is $T_s +
\kappa V = 0$, a condition for the vesicle velocity is
\begin{align}
  (\mbu \cdot \mbs)_s = -\kappa(\beta (\mbf \cdot \mbn) + 
      \mbu \cdot \mbn).
\end{align}
This equation can be solved following equations (32)--(39)
in~\cite{soh-tse-li-voi-low2010}, with the only difference being that
$\tilde{\mbu}$ satisfies
\begin{align}
  (\tilde{\mbu} \cdot \mbs)_s + \kappa(\tilde{\mbu} \cdot \mbn) =
    -(\mbv \cdot \mbs)_s - \kappa(\mbv \cdot \mbn) 
    - \beta\kappa(\mbf \cdot \mbn).
\end{align}
Compared to equation (40), only the last term is new.


%%%%%%%%%%%%%%
Finally, we write the time stepping method in matrix form as
\begin{align}
  A \left(
    \begin{array}{c}
      \mbx^{N+1} \\ \sigma^{N+1}
    \end{array}
  \right) = 
  \left(
    \begin{array}{c}
      \mbx^{N} + \Delta t \mbu_\infty(\mbx^N) \\ \mathbf{1}
    \end{array}
  \right),
\end{align}
where
\begin{align}
 A = \left(
  \begin{array}{cc}
    I + \Delta t \beta P^N B^N + \Delta t \sgl^N B^N & 
    -\Delta t P^N T^N - \Delta t \sgl^N T^N \\
    D^N & 0
  \end{array}
  \right).
\end{align}

\section{Area of a Vesicle}
The area inside a single vesicle $\gamma$ parameterized with $\mbx$ is
\begin{align}
  A(t) = \int_{\gamma} (\mbx \cdot \mbn)\, ds = 
    \int_{0}^{2\pi} \left(\mbx \cdot \pderiv{\mbx}{\theta}^\perp\right)
    \, d\theta.
\end{align}
Taking the time derivative of $A(t)$,
\begin{align}
  \dot{A}(t) &= \int_{0}^{2\pi} \left(
    \dot{\mbx} \cdot \pderiv{\mbx}{\theta}^{\perp} + 
    \mbx \cdot \pderiv{\dot{\mbx}}{\theta}^{\perp}\right) \\
    \, d\theta.
  &= \int_{0}^{2\pi} \left(
    (\dot{\mbx} \cdot \mbn)\|\mbx'(\theta)\| \right) d\theta +
     \int_{0}^{2\pi}
    \mbx \cdot \frac{d}{dt}\left(\mbn |\frac{d\mbx}{d\theta}| \right)
\end{align}

\section{Including a concentration field}
Based on the work of Yao and Mori~\cite{yao-mor2017}, we introduce a
chemical concentration field $c$.  The concentration field is governed
by the advection-diffusion equation
\begin{align}
  \pderiv{c}{t} + \nabla \cdot (\mbu c) = D\Delta c.
\end{align}
If the concentration is diffusion dominated (zero Peclet number), then
the concentration satisfies
\begin{align}
  \Delta c = 0, \quad \mbx \in \RR^2.
\end{align}
The boundary conditions of the concentration field on the vesicle
$\gamma$ are
\begin{align}
  (\mbu c - D\nabla c) \cdot \mbn = c \pderiv{\mbx}{t} \cdot \mbn + 
    j_c + j_p,
\end{align}
where $j_c$ and $j_p$ are the transmembrane chemical flux due to passive
transport and active transport (pumps), respectively.  In the zero
Peclet number limit, the absence of an active transport mechanism, and
the choice for the passive flux, the boundary condition of the
concentration field is
\begin{align}
  -D\pderiv{c}{\mbn} = c \pderiv{\mbx}{t} + 
    k_c \jump{c}, \quad \mbx \in \gamma.
\end{align}
To couple the vesicle dynamics to the concentration, there is a
difference between the fluid velocity and vesicle velocity
\begin{align}
  \mbu - \pderiv{\mbx}{t} = j_w \mbn,
\end{align}
where $j_w$ is the water flux through the vesicle.  This is the
osmophoretic flow.  In~\cite{yao-mor2017}, this flux is
\begin{align}
  j_w = -k_w(RT\jump{c} + \mbf_\text{mem} \cdot \mbn).
\end{align}
In our current implementation, we drop the $RT\jump{c}$ term, and
let $\beta = k_w$.

\section{Preliminary results}


\begin{figure}
	\centering
	\includegraphics[width=.9\textwidth]{figures/1.jpg}
	\includegraphics[width=.9\textwidth]{figures/2.jpg}
	\includegraphics[width=.9\textwidth]{figures/3.jpg}
	\caption{Reduced area as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 0$.}
%	\label{Shear0}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=.9\textwidth]{figures/4.jpg}
	\includegraphics[width=.9\textwidth]{figures/5.jpg}
	\includegraphics[width=.9\textwidth]{figures/6.jpg}
	\caption{Reduced area as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 0.5$.}
%	\label{Shear0}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=.9\textwidth]{figures/7.jpg}
	\includegraphics[width=.9\textwidth]{figures/8.jpg}
	\includegraphics[width=.9\textwidth]{figures/9.jpg}
	\caption{Reduced area as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 1$.}
%	\label{Shear0}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=.9\textwidth]{figures/10.jpg}
	\includegraphics[width=.9\textwidth]{figures/11.jpg}
	\includegraphics[width=.9\textwidth]{figures/12.jpg}
	\caption{Reduced area as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 2$.}
%	\label{Shear0}
\end{figure}
 
 
 \begin{figure}
 	\centering
 	\includegraphics[width=.9\textwidth]{figures/BE1.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE2.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE3.jpg}
 	\caption{Bending energy as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 0$.}
% 	\label{Shear0}
 \end{figure}
 
 \begin{figure}
 	\centering
 	\includegraphics[width=.9\textwidth]{figures/BE4.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE5.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE6.jpg}
 	\caption{Bending energy as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 0.5$.}
% 	\label{Shear0}
 \end{figure}
 
 \begin{figure}
 	\centering
 	\includegraphics[width=.9\textwidth]{figures/BE7.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE8.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE9.jpg}
 	\caption{Bending energy as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 1$.}
% 	\label{Shear0}
 \end{figure}
 
 \begin{figure}
 	\centering
 	\includegraphics[width=.9\textwidth]{figures/BE10.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE11.jpg}
 	\includegraphics[width=.9\textwidth]{figures/BE12.jpg}
 	\caption{Bending energy as a function of time for $\beta = [0, 10^{-2},10^{-1}, 1]$ with a shear flow rate $\chi = 2$.}
 	\label{Shear0}
 \end{figure}


\end{document}
